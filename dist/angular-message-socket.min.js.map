{"version":3,"file":"angular-message-socket.min.js","sources":["angular-message-socket.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"__bind","fn","me","apply","arguments","angular","module","factory","$window","WebSocket","provider","$logProvider","DELAYED_QUEUE_SIZE","MAX_RECONNECTS","MESSAGE_TYPE","RECONNECT_TIMEOUT","this","messageTypeKey","key","reconnectTimeout","millis","maxReconnects","count","delayedQueueSize","size","$get","$rootScope","$timeout","$log","$q","AskContext","BoundedQueue","MessageSocket","queueSize","items","prototype","enqueue","message","pop","unshift","dequeue","messenger","askMessage","responseTimeout","messageId","Date","now","contextReceives","deferreds","tellSent","responseNames","deferred","defer","push","tell","receive","_this","response","resolve","forEach","cancel","timeoutPromise","reject","promise","url","handlers","outbox","uniqueId","Math","random","toString","substr","onOpen","nextMessage","_results","connected","reconnects","debug","send","JSON","stringify","onMessage","handler","json","receiveId","_ref","fromJson","data","$apply","reconnect","nextTimeout","floor","pow","connect","$emit","debugEnabled","alert","onError","socket","onopen","onmessage","onclose","wasClean","onerror","onbeforeunload","close","messageNames","messageHandler","messageName","_i","_len","isFunction","isString","_j","_len1","_","stamp","withTimeout","after"],"mappings":";;CAAA,QAAUA,GAAEC,EAAEC,EAAEC,GAAG,QAASC,GAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,GAAIE,GAAkB,kBAATC,UAAqBA,OAAQ,KAAIF,GAAGC,EAAE,MAAOA,GAAEF,GAAE,EAAI,IAAGI,EAAE,MAAOA,GAAEJ,GAAE,EAAI,IAAIK,GAAE,GAAIC,OAAM,uBAAuBN,EAAE,IAAK,MAAMK,GAAEE,KAAK,mBAAmBF,EAAE,GAAIG,GAAEX,EAAEG,IAAIS,WAAYb,GAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAG,GAAIE,GAAED,EAAEI,GAAG,GAAGL,EAAG,OAAOI,GAAEF,EAAEA,EAAEF,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,MAAOD,GAAEG,GAAGS,QAAkD,IAAI,GAA1CL,GAAkB,kBAATD,UAAqBA,QAAgBH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,GAAI,OAAOD,KAAKa,GAAG,YAC/b,WACE,YACA,IAAIC,GAAS,SAASC,EAAIC,GAAK,MAAO,YAAY,MAAOD,GAAGE,MAAMD,EAAIE,YAEtEC,SAAQC,OAAO,8BAA+BC,QAAQ,aACpD,UAAW,SAASC,GAClB,MAAOA,GAAQC,aAEhBC,SAAS,iBACV,eAAgB,SAASC,GACvB,GAAIC,GAAoBC,EAAgBC,EAAcC,CAwRtD,OAvRAD,GAAe,WACfE,KAAKC,eAAiB,SAASC,GAC7B,MAAOJ,GAAeI,GAExBH,EAAoB,IACpBC,KAAKG,iBAAmB,SAASC,GAC/B,MAAOL,GAAoBK,GAE7BP,EAAiB,GACjBG,KAAKK,cAAgB,SAASC,GAC5B,MAAOT,GAAiBS,GAE1BV,EAAqB,GACrBI,KAAKO,iBAAmB,SAASC,GAC/B,MAAOZ,GAAqBY,QAE9BR,KAAKS,MACH,aAAc,WAAY,UAAW,OAAQ,KAAM,YAAa,SAASC,EAAYC,EAAUnB,EAASoB,EAAMC,EAAIpB,GAChH,GAAIqB,GAAYC,EAAcC,CA+E9B,OA9EAD,GAAe,WACb,QAASA,GAAaE,GACpBjB,KAAKiB,UAAYA,EACjBjB,KAAKkB,SAkBP,MAfAH,GAAaI,UAAUC,QAAU,SAASC,GAIxC,MAHIrB,MAAKkB,MAAMpC,SAAWkB,KAAKiB,WAC7BjB,KAAKkB,MAAMI,MAENtB,KAAKkB,MAAMK,QAAQF,IAG5BN,EAAaI,UAAUK,QAAU,WAC/B,MAAOxB,MAAKkB,MAAMI,OAGpBP,EAAaI,UAAUX,KAAO,WAC5B,MAAOR,MAAKkB,MAAMpC,QAGbiC,KAGTD,EAAa,WACX,QAASA,GAAWW,EAAWC,EAAYC,GACzC3B,KAAKyB,UAAYA,EACjBzB,KAAK0B,WAAaA,EAClB1B,KAAK2B,gBAAkBA,EACvB3B,KAAK4B,UAAYC,KAAKC,MACtB9B,KAAK+B,mBACL/B,KAAKgC,aACLhC,KAAKiC,UAAW,EA2ClB,MAhCAnB,GAAWK,UAAU,OAAS,SAASe,GACrC,GAAIC,EA4BJ,OA3BAA,GAAWtB,EAAGuB,QACdpC,KAAKgC,UAAUK,KAAKF,GACfnC,KAAKiC,WACRjC,KAAKyB,UAAUa,KAAKtC,KAAK0B,WAAY1B,KAAK4B,WAC1C5B,KAAKiC,UAAW,GAElBjC,KAAK+B,gBAAgBM,KAAKrC,KAAKyB,UAAUc,QAAQL,EAAe,SAAUM,GACxE,MAAO,UAASC,GAKd,MAJAN,GAASO,QAAQD,GACjBD,EAAMT,gBAAgBY,QAAQ,SAASC,GACrC,MAAOA,OAEFjC,EAASiC,OAAOJ,EAAMK,kBAE9B7C,QACEA,KAAK6C,iBACR7C,KAAK6C,eAAiBlC,EAAS,SAAU6B,GACvC,MAAO,YAIL,MAHAA,GAAMT,gBAAgBY,QAAQ,SAASC,GACrC,MAAOA,OAEFJ,EAAMR,UAAUW,QAAQ,SAASR,GACtC,MAAOA,GAASW,OAAO,GAAIrE,OAAM,gDAAkD+D,EAAMd,WAAW5B,GAAgB,mBAAqB0C,EAAMb,gBAAkB,YAGpK3B,MAAOA,KAAK2B,kBAEVQ,EAASY,SAGXjC,KAGFE,EAAgB,WA+BrB,QAASA,GAAcgC,GACrBhD,KAAKuC,QAAUvD,EAAOgB,KAAKuC,QAASvC,MACpCA,KAAKiD,YACLjD,KAAKkD,OAAS,GAAInC,GAAanB,GAC/BI,KAAKmD,SAAW,WACd,MAAO,IAAMC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,IAEpDvD,KAAKwD,OAAS,SAAUhB,GACtB,MAAO,YACL,GAAIiB,GAAaC,CAIjB,IAHAlB,EAAMmB,WAAY,EAClBnB,EAAMoB,WAAa,EACnBhD,EAAKiD,MAAM,yBACPrB,EAAMU,OAAO1C,OAAQ,CAEvB,IADAkD,KACQD,EAAcjB,EAAMU,OAAO1B,WACjCZ,EAAKiD,MAAM,qBAAsBJ,EAAY3D,GAAe2D,GAC5DC,EAASrB,KAAKG,EAAMsB,KAAKC,KAAKC,UAAUP,IAE1C,OAAOC,MAGV1D,MACHA,KAAKiE,UAAY,SAAUzB,GACzB,MAAO,UAASnB,GACd,GAAI6C,GAASC,EAAMC,EAAWC,EAAMX,CAGpC,IAFAS,EAAO9E,QAAQiF,SAASjD,EAAQkD,MAChC3D,EAAKiD,MAAM,yBAA0BM,EAAKrE,GAAeqE,GACd,MAAtC3B,EAAMS,SAASkB,EAAKrE,IAAyB,CAChDuE,EAAO7B,EAAMS,SAASkB,EAAKrE,IAC3B4D,IACA,KAAKU,IAAaC,GAChBH,EAAUG,EAAKD,GACfV,EAASrB,KAAK3B,EAAW8D,OAAO,WAC9B,MAAON,GAAQC,KAGnB,OAAOT,MAGV1D,MACHA,KAAKyE,UAAY,SAAUjC,GACzB,MAAO,YACL,GAAIkC,EACJ,OAAIlC,GAAMoB,aAAe/D,GAMvB6E,EAActB,KAAKuB,MAAMvB,KAAKC,SAAWD,KAAKwB,IAAI,EAAGpC,EAAMoB,YAAc7D,GACzEa,EAAKiD,MAAM,sDAAwDa,EAAc,QAC1E/D,EAAS,WAEd,MADA6B,GAAMoB,YAAc,EACbpB,EAAMqC,QAAQ7B,IACpB0B,KAVHhE,EAAWoE,MAAM,6BAA8BjD,KAAKC,OAC9CnC,EAAaoF,eAAnB,OACSvF,EAAQwF,MAAM,mEAW1BhF,MACHA,KAAKiF,QAAU,WACb,MAAO,UAAS5D,GACd,MAAOT,GAAKiD,MAAM,qCAAsCxC,KAEzDrB,MACHA,KAAK6E,QAAQ7B,GAkFf,MAhLAhC,GAAcG,UAAUwC,WAAY,EAEpC3C,EAAcG,UAAUyC,WAAa,EAErC5C,EAAcG,UAAU0D,QAAU,SAAS7B,GAgBzC,MAfAhD,MAAKkF,OAAS,GAAIzF,GAAUuD,GAC5BhD,KAAKkF,OAAOC,OAASnF,KAAKwD,OAC1BxD,KAAKkF,OAAOE,UAAYpF,KAAKiE,UAC7BjE,KAAKkF,OAAOG,QAAU,SAAU7C,GAC9B,MAAO,UAASnB,GAEd,MADAmB,GAAMmB,WAAY,EACbtC,EAAQiE,SAAb,OACS9C,EAAMiC,UAAUpD,KAG1BrB,MACHA,KAAKkF,OAAOK,QAAUvF,KAAKiF,QAC3BjF,KAAK8D,KAAO,SAASzC,GACnB,MAAOrB,MAAKkF,OAAOpB,KAAKzC,IAEnB7B,EAAQgG,eAAiB,SAAUhD,GACxC,MAAO,YAEL,MADAA,GAAM0C,OAAOO,QACP9F,EAAaoF,eAAnB,OACS,2DAGV/E,OA8ELgB,EAAcG,UAAUoB,QAAU,SAASmD,EAAcC,GACvD,GAAIC,GAAaxB,EAAWyB,EAAIC,CAChC,KAAKzG,QAAQ0G,WAAWJ,GACtB,KAAMlH,OAAM,oBAMd,KAJIY,QAAQ2G,SAASN,KACnBA,GAAgBA,IAElBtB,EAAYpE,KAAKmD,WACZ0C,EAAK,EAAGC,EAAOJ,EAAa5G,OAAagH,EAALD,EAAWA,IAClDD,EAAcF,EAAaG,GACO,MAA9B7F,KAAKiD,SAAS2C,KAChB5F,KAAKiD,SAAS2C,OAEhB5F,KAAKiD,SAAS2C,GAAaxB,GAAauB,CAE1C,OAAO,UAAUnD,GACf,MAAO,YACL,GAAIyD,GAAIC,EAAOxC,CAEf,KADAA,KACKuC,EAAK,EAAGC,EAAQR,EAAa5G,OAAaoH,EAALD,EAAYA,IACpDL,EAAcF,EAAaO,GAC3BvC,EAASrB,WAAYG,GAAMS,SAAS2C,GAAaxB,GAEnD,OAAOV,KAER1D,OAULgB,EAAcG,UAAUmB,KAAO,SAASjB,EAASO,GAQ/C,GAPiB,MAAbA,IACFA,EAAY,MAEVP,EAAQ8E,IACV9E,EAAQvB,GAAgBuB,EAAQ8E,QACzB9E,GAAQ8E,IAEZ9E,EAAQvB,GACX,KAAMrB,OAAM,uBAUd,OARA4C,GAAQ+E,MAAQxE,EAAYA,EAAYC,KAAKC,MACxC9B,KAAK2D,WAIR/C,EAAKiD,MAAM,qBAAsBxC,EAAQvB,GAAeuB,GACxDrB,KAAK8D,KAAKC,KAAKC,UAAU3C,MAJzBT,EAAKiD,MAAM,yBAA0BxC,EAAQvB,GAAeuB,GAC5DrB,KAAKkD,OAAO9B,QAAQC,IAKfA,EAAQ+E,OAUjBpF,EAAcG,UAAUkF,YAAc,SAASC,GAC7C,MAAO,UAAS5E,GACd,MAAO,IAAIZ,GAAWd,KAAM0B,EAAY4E,KAIrCtF,aAShBnC,KAAKmB,gBAEG"}